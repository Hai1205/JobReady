# OAuth2 Production Configuration
# File: auth-service/src/main/resources/application-oauth2-prod.properties

# ===================================
# SERVER CONFIGURATION
# ===================================
server.port=${PORT:8082}
spring.application.name=auth-service

# Eureka Configuration
eureka.client.service-url.defaultZone=${EUREKA_URL:http://eureka-server:8761/eureka/}
eureka.instance.prefer-ip-address=true
eureka.instance.hostname=${HOST_NAME:auth-service}

# ===================================
# JWT CONFIGURATION
# ===================================
app.jwt.private-key-path=${JWT_PRIVATE_KEY_PATH:file:/secrets/private-key.pem}
app.jwt.public-key-path=${JWT_PUBLIC_KEY_PATH:file:/secrets/public-key.pem}
app.jwt.expiration=${JWT_EXPIRATION:86400000}

# ===================================
# DATABASE CONFIGURATION (if needed)
# ===================================
spring.datasource.url=${DATABASE_URL:jdbc:mysql://mysql:3306/authdb}
spring.datasource.username=${DATABASE_USERNAME:root}
spring.datasource.password=${DATABASE_PASSWORD}
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.show-sql=false

# ===================================
# RABBITMQ CONFIGURATION
# ===================================
spring.rabbitmq.host=${RABBITMQ_HOST:rabbitmq}
spring.rabbitmq.port=${RABBITMQ_PORT:5672}
spring.rabbitmq.username=${RABBITMQ_USERNAME:admin}
spring.rabbitmq.password=${RABBITMQ_PASSWORD}
spring.rabbitmq.ssl.enabled=${RABBITMQ_SSL_ENABLED:false}

# ===================================
# OAUTH2 PROVIDERS CONFIGURATION
# ===================================

# Google OAuth2 Configuration
spring.security.oauth2.client.registration.google.client-id=${GOOGLE_CLIENT_ID}
spring.security.oauth2.client.registration.google.client-secret=${GOOGLE_CLIENT_SECRET}
spring.security.oauth2.client.registration.google.scope=profile,email
spring.security.oauth2.client.registration.google.redirect-uri=${APP_BASE_URL}/oauth2/callback/google

spring.security.oauth2.client.provider.google.authorization-uri=https://accounts.google.com/o/oauth2/v2/auth
spring.security.oauth2.client.provider.google.token-uri=https://www.googleapis.com/oauth2/v4/token
spring.security.oauth2.client.provider.google.user-info-uri=https://www.googleapis.com/oauth2/v2/userinfo
spring.security.oauth2.client.provider.google.user-name-attribute=sub

# Facebook OAuth2 Configuration
spring.security.oauth2.client.registration.facebook.client-id=${FACEBOOK_APP_ID}
spring.security.oauth2.client.registration.facebook.client-secret=${FACEBOOK_APP_SECRET}
spring.security.oauth2.client.registration.facebook.scope=email,public_profile
spring.security.oauth2.client.registration.facebook.redirect-uri=${APP_BASE_URL}/oauth2/callback/facebook

spring.security.oauth2.client.provider.facebook.authorization-uri=https://www.facebook.com/v18.0/dialog/oauth
spring.security.oauth2.client.provider.facebook.token-uri=https://graph.facebook.com/v18.0/oauth/access_token
spring.security.oauth2.client.provider.facebook.user-info-uri=https://graph.facebook.com/v18.0/me?fields=id,name,email
spring.security.oauth2.client.provider.facebook.user-name-attribute=id

# GitHub OAuth2 Configuration
spring.security.oauth2.client.registration.github.client-id=${GITHUB_CLIENT_ID}
spring.security.oauth2.client.registration.github.client-secret=${GITHUB_CLIENT_SECRET}
spring.security.oauth2.client.registration.github.scope=user:email
spring.security.oauth2.client.registration.github.redirect-uri=${APP_BASE_URL}/oauth2/callback/github

spring.security.oauth2.client.provider.github.authorization-uri=https://github.com/login/oauth/authorize
spring.security.oauth2.client.provider.github.token-uri=https://github.com/login/oauth/access_token
spring.security.oauth2.client.provider.github.user-info-uri=https://api.github.com/user
spring.security.oauth2.client.provider.github.user-name-attribute=id

# ===================================
# MICROSERVICES COMMUNICATION
# ===================================
user-service.base-url=${USER_SERVICE_URL:http://user-service:8083}

# ===================================
# CLIENT CONFIGURATION
# ===================================
app.frontend.success-url=${FRONTEND_SUCCESS_URL:https://yourdomain.com/login-success}
app.frontend.error-url=${FRONTEND_ERROR_URL:https://yourdomain.com/login-error}

# ===================================
# SECURITY CONFIGURATION
# ===================================
server.ssl.enabled=${SSL_ENABLED:true}
server.ssl.key-store=${SSL_KEYSTORE_PATH:file:/secrets/keystore.p12}
server.ssl.key-store-password=${SSL_KEYSTORE_PASSWORD}
server.ssl.key-store-type=PKCS12

# CORS Configuration
app.cors.allowed-origins=${CORS_ALLOWED_ORIGINS:https://yourdomain.com,https://www.yourdomain.com}
app.cors.allowed-methods=GET,POST,PUT,DELETE,OPTIONS
app.cors.allowed-headers=*
app.cors.allow-credentials=true

# ===================================
# LOGGING CONFIGURATION
# ===================================
logging.level.com.example.authservice=${LOG_LEVEL:INFO}
logging.level.org.springframework.security=WARN
logging.level.org.springframework.security.oauth2=INFO
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %msg%n
logging.file.name=${LOG_FILE_PATH:/app/logs/auth-service.log}

# ===================================
# ACTUATOR CONFIGURATION
# ===================================
management.endpoints.web.exposure.include=health,info,metrics,prometheus
management.endpoint.health.show-details=when_authorized
management.metrics.export.prometheus.enabled=true

# Health Check Configuration
management.health.redis.enabled=false
management.health.rabbit.enabled=true
management.health.diskspace.enabled=true

# ===================================
# PERFORMANCE TUNING
# ===================================
server.tomcat.threads.max=${MAX_THREADS:200}
server.tomcat.threads.min-spare=${MIN_THREADS:10}
server.tomcat.connection-timeout=${CONNECTION_TIMEOUT:20000}

# ===================================
# ENVIRONMENT VARIABLES REQUIRED
# ===================================
# APP_BASE_URL=https://api.yourdomain.com
# GOOGLE_CLIENT_ID=your_google_client_id
# GOOGLE_CLIENT_SECRET=your_google_client_secret
# FACEBOOK_APP_ID=your_facebook_app_id
# FACEBOOK_APP_SECRET=your_facebook_app_secret
# GITHUB_CLIENT_ID=your_github_client_id
# GITHUB_CLIENT_SECRET=your_github_client_secret
# DATABASE_PASSWORD=your_db_password
# RABBITMQ_PASSWORD=your_rabbitmq_password
# SSL_KEYSTORE_PASSWORD=your_ssl_password
# FRONTEND_SUCCESS_URL=https://yourdomain.com/login-success
# FRONTEND_ERROR_URL=https://yourdomain.com/login-error