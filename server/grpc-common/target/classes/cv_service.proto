syntax = "proto3";

option java_multiple_files = true;
option java_package = "com.example.grpc.cv";
option java_outer_classname = "CVServiceProto";

package cv;

// CV Service Definition
service CVService {
  // Get total CVs count
  rpc GetTotalCVs(GetTotalCVsRequest) returns (GetTotalCVsResponse);
  
  // Get CVs by visibility
  rpc GetCVsByVisibility(GetCVsByVisibilityRequest) returns (GetCVsByVisibilityResponse);
  
  // Get CVs created in date range
  rpc GetCVsCreatedInRange(GetCVsCreatedInRangeRequest) returns (GetCVsCreatedInRangeResponse);
  
  // Get recent CVs
  rpc GetRecentCVs(GetRecentCVsRequest) returns (GetRecentCVsResponse);

  // Create a new CV
  rpc CreateCV(CreateCVRequest) returns (CreateCVResponse);
}

// Request Messages
message GetTotalCVsRequest {
}

message GetCVsByVisibilityRequest {
  bool is_visibility = 1;
}

message GetCVsCreatedInRangeRequest {
  string start_date = 1; // ISO format
  string end_date = 2;   // ISO format
}

message GetRecentCVsRequest {
  int32 limit = 1;
}

message CreateCVRequest {
  string user_id = 1;
  string title = 2;
  PersonalInfo personal_info = 3;
  repeated Experience experiences = 4;
  repeated Education educations = 5;
  repeated string skills = 6;
}

// Response Messages
message GetTotalCVsResponse {
  int32 code = 1;
  string message = 2;
  int64 total = 3;
}

message GetCVsByVisibilityResponse {
  int32 code = 1;
  string message = 2;
  int64 count = 3;
}

message GetCVsCreatedInRangeResponse {
  int32 code = 1;
  string message = 2;
  int64 count = 3;
}

message GetRecentCVsResponse {
  int32 code = 1;
  string message = 2;
  repeated CVInfo cvs = 3;
}

message CreateCVResponse {
  int32 code = 1;
  string message = 2;
  CVInfo cv = 3;
}

// CV Info
message CVInfo {
  string id = 1;
  string title = 2;
  string user_id = 3;
  string created_at = 4;
  bool is_visibility = 5;
  PersonalInfo personal_info = 6;
  repeated Experience experiences = 7;
  repeated Education educations = 8;
  repeated string skills = 9;
}

message PersonalInfo {
  string id = 1;
  string fullname = 2;
  string email = 3;
  string phone = 4;
  string location = 5;
  string summary = 6;
  string avatar_url = 7;
  string avatar_public_id = 8;
}

message Experience {
  string id = 1;
  string company = 2;
  string position = 3;
  string start_date = 4;
  string end_date = 5;
  string description = 6;
}

message Education {
  string id = 1;
  string school = 2;
  string degree = 3;
  string field = 4;
  string start_date = 5;
  string end_date = 6;
}
